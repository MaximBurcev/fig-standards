
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>PSR 17 http factory meta - Стандартизированные рекомендации PHP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#http-factories-meta" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Стандартизированные рекомендации PHP" class="md-header-nav__button md-logo" aria-label="Стандартизированные рекомендации PHP">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Стандартизированные рекомендации PHP
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              PSR 17 http factory meta
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Стандартизированные рекомендации PHP" class="md-nav__button md-logo" aria-label="Стандартизированные рекомендации PHP">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Стандартизированные рекомендации PHP
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Стандартизированные рекомендации PHP
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-0/" class="md-nav__link">
        Стандарт автозагрузки PSR-0 (Устарело)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-1-basic-coding-standard/" class="md-nav__link">
        Основной стандарт кодирования PSR-1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-2-coding-style-guide/" class="md-nav__link">
        Руководство по стилю кодирования PSR-2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-3-logger-interface/" class="md-nav__link">
        Общий интерфейс логирования PSR-3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-4-autoloader/" class="md-nav__link">
        Стандарт автозагрузки PSR-4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-4-autoloader-examples/" class="md-nav__link">
        Примеры реализации PSR-4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../proposed/phpdoc/" class="md-nav__link">
        PHPDoc PSR-5
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-6-cache/" class="md-nav__link">
        Общий интерфейс кэширования PSR-6
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../PSR-12-extended-coding-style-guide/" class="md-nav__link">
        Расширенное руководство по стилю кодирования PSR-12
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../LICENSE/" class="md-nav__link">
        Лицензия
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-summary" class="md-nav__link">
    1. Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-why-bother" class="md-nav__link">
    2. Why Bother?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-scope" class="md-nav__link">
    3. Scope
  </a>
  
    <nav class="md-nav" aria-label="3. Scope">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-goals" class="md-nav__link">
    3.1 Goals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-non-goals" class="md-nav__link">
    3.2 Non-Goals
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-approaches" class="md-nav__link">
    4. Approaches
  </a>
  
    <nav class="md-nav" aria-label="4. Approaches">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-chosen-approach" class="md-nav__link">
    4.1 Chosen Approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-existing-implementations" class="md-nav__link">
    4.2 Existing Implementations
  </a>
  
    <nav class="md-nav" aria-label="4.2 Existing Implementations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-diactoros" class="md-nav__link">
    4.2.1 Diactoros
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-guzzle" class="md-nav__link">
    4.2.2 Guzzle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423-slim" class="md-nav__link">
    4.2.3 Slim
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-potential-issues" class="md-nav__link">
    4.3 Potential Issues
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-design-decisions" class="md-nav__link">
    5. Design Decisions
  </a>
  
    <nav class="md-nav" aria-label="5. Design Decisions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-why-php-7" class="md-nav__link">
    5.1 Why PHP 7?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-why-multiple-interfaces" class="md-nav__link">
    5.2 Why multiple interfaces?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-why-does-the-reasonphrase-argument-to-the-responsefactoryinterface-exist" class="md-nav__link">
    5.3 Why does the $reasonPhrase argument to the ResponseFactoryInterface exist?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-why-does-the-serverparams-argument-to-the-serverrequestfactoryinterface-exist" class="md-nav__link">
    5.4 Why does the $serverParams argument to the ServerRequestFactoryInterface exist?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-why-is-there-no-factory-for-creating-a-serverrequestinterface-from-superglobals" class="md-nav__link">
    5.5 Why is there no factory for creating a ServerRequestInterface from superglobals?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56-why-does-requestfactoryinterfacecreaterequest-allow-a-string-uri" class="md-nav__link">
    5.6 Why does RequestFactoryInterface::createRequest allow a string URI?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-people" class="md-nav__link">
    6. People
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-votes" class="md-nav__link">
    7. Votes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-relevant-links" class="md-nav__link">
    8. Relevant Links
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="http-factories-meta">HTTP Factories Meta</h1>
<h2 id="1-summary">1. Summary</h2>
<p>The purpose of this PSR is to provide factory interfaces that define methods to
create <a href="https://www.php-fig.org/psr/psr-7/">PSR-7</a> objects.</p>
<h2 id="2-why-bother">2. Why Bother?</h2>
<p>The current specification for PSR-7 allows for most objects to be modified by
creating immutable copies. However, there are two notable exceptions:</p>
<ul>
<li><code>StreamInterface</code> is a mutable object based on a resource that only allows
  the resource to be written to when the resource is writable.</li>
<li><code>UploadedFileInterface</code> is a read-only object based on a resource that offers
  no modification capabilities.</li>
</ul>
<p>The former is a significant pain point for PSR-7 middleware, as it can leave
the response in an incomplete state. If the stream attached to the response body
is not seekable or not writable, there is no way to recover from an error
condition in which the body has already been written to.</p>
<p>This scenario can be avoided by providing a factory to create new streams. Due to
the lack of a formal standard for HTTP object factories, a developer must rely on
a specific vendor implementation in order to create these objects.</p>
<p>Another pain point is when writing re-usable middleware or request handlers. In
such cases, package authors may need to create and return a response. However,
creating discrete instances then ties the package to a specific PSR-7
implementation. If these packages rely on the request factory interface instead,
they can remain agnostic of the PSR-7 implementation.</p>
<p>Creating a formal standard for factories will allow developers to avoid
dependencies on specific implementations while having the ability to create new
objects when necessary.</p>
<h2 id="3-scope">3. Scope</h2>
<h3 id="31-goals">3.1 Goals</h3>
<ul>
<li>Provide a set of interfaces that define methods to create PSR-7 compatible objects.</li>
</ul>
<h3 id="32-non-goals">3.2 Non-Goals</h3>
<ul>
<li>Provide a specific implementation of PSR-7 factories.</li>
</ul>
<h2 id="4-approaches">4. Approaches</h2>
<h3 id="41-chosen-approach">4.1 Chosen Approach</h3>
<p>The factory method definition has been chosen based on whether or not the object
can be modified after instantiation. For interfaces that cannot be modified, all
of the object properties must be defined at the time of instantiation.</p>
<p>In the case of <code>UriInterface</code> a complete URI may be passed for convenience.</p>
<p>The method names used will not conflict. This allows for a single class to
implement multiple interfaces when appropriate.</p>
<h3 id="42-existing-implementations">4.2 Existing Implementations</h3>
<p>All of the current implementations of PSR-7 have defined their own requirements.
In most cases, the required parameters are the same or less strict than the proposed
factory methods.</p>
<h4 id="421-diactoros">4.2.1 Diactoros</h4>
<p><a href="https://docs.zendframework.com/zend-diactoros/">Diactoros</a> was one of the first HTTP Messages implementations for
server usage, and was developed parallel to the PSR-7 specification.</p>
<ul>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/Request.php#L33"><code>Request</code></a> No required parameters, method and URI default to <code>null</code>.</li>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/Response.php#L114"><code>Response</code></a> No required parameters, status code defaults to <code>200</code>.</li>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/ServerRequest.php#L78-L89"><code>ServerRequest</code></a> No required parameters. Contains a separate
  <a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/ServerRequestFactory.php#L52-L58"><code>ServerRequestFactory</code></a> for creating requests from globals.</li>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/Stream.php#L36"><code>Stream</code></a> Requires <code>string|resource $stream</code> for the body.</li>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/UploadedFile.php#L62"><code>UploadedFile</code></a> Requires <code>string|resource $streamOrFile</code>, <code>int $size</code>,
  <code>int $errorStatus</code>. Error status must be a PHP upload constant.</li>
<li><a href="https://github.com/zendframework/zend-diactoros/blob/b4e7758556c97b5bb9a5260d898e9788ee800538/src/Uri.php#L94"><code>Uri</code></a> No required parameters, <code>string $uri</code> is empty by default.</li>
</ul>
<p>Overall this approach is quite similar to the proposed factories. In some cases,
more options are given by Diactoros which are not required for a valid object.
The proposed uploaded file factory allows for size and error status to be optional.</p>
<h4 id="422-guzzle">4.2.2 Guzzle</h4>
<p><a href="https://github.com/guzzle/psr7">Guzzle</a> is an HTTP Messages implementation that focuses on client usage.</p>
<ul>
<li><a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/Request.php#L32-L38"><code>Request</code></a> Requires both <code>string $method</code> and <code>string|UriInterface $uri</code>.</li>
<li><a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/Response.php#L88-L94"><code>Response</code></a> No required parameters, status code defaults to <code>200</code>.</li>
<li><a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/Stream.php#L51"><code>Stream</code></a> Requires <code>resource $stream</code> for the body.</li>
<li><a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/Uri.php#L48"><code>Uri</code></a> No required parameters, <code>string $uri</code> is empty by default.</li>
</ul>
<p><em>Being geared towards client usage, Guzzle does not contain a <code>ServerRequest</code> or
<code>UploadedFile</code> implementation.</em></p>
<p>Overall this approach is also quite similar to the proposed factories. One notable
difference is that Guzzle requires streams to be constructed with a resource and
does not allow a string. However, it does contain a helper function <a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/functions.php#L78"><code>stream_for</code></a>
that will create a stream from a string of content and a function <a href="https://github.com/guzzle/psr7/blob/58828615f7bb87013ce6365e9b1baa08580c7fc8/src/functions.php#L295"><code>try_fopen</code></a>
that will create a resource from a file path.</p>
<h4 id="423-slim">4.2.3 Slim</h4>
<p><a href="https://www.slimframework.com/">Slim</a> is a micro-framework that makes use of HTTP Messages from version
3.0 forward.</p>
<ul>
<li><a href="https://github.com/slimphp/Slim/blob/30cfe3c07dac28ec1129c0577e64b90ba11a54c4/Slim/Http/Request.php#L170-L178"><code>Request</code></a> Requires <code>string $method</code>, <code>UriInterface $uri</code>,
  <code>HeadersInterface $headers</code>, <code>array $cookies</code>, <code>array $serverParams</code>, and
  <code>StreamInterface $body</code>. Contains a factory method <code>createFromEnvironment(Environment $environment)</code>
  that is framework specific but analogous to the proposed <code>createServerRequestFromArray</code>.</li>
<li><a href="https://github.com/slimphp/Slim/blob/30cfe3c07dac28ec1129c0577e64b90ba11a54c4/Slim/Http/Response.php#L123"><code>Response</code></a> No required parameters, status code defaults to <code>200</code>.</li>
<li><a href="https://github.com/slimphp/Slim/blob/30cfe3c07dac28ec1129c0577e64b90ba11a54c4/Slim/Http/Stream.php#L96"><code>Stream</code></a> Requires <code>resource $stream</code> for the body.</li>
<li><a href="https://github.com/slimphp/Slim/blob/30cfe3c07dac28ec1129c0577e64b90ba11a54c4/Slim/Http/UploadedFile.php#L151"><code>UploadedFile</code></a> Requires <code>string $file</code> for the source file.
  Contains a factory method <code>parseUploadedFiles(array $uploadedFiles)</code> for creating
  an array of <code>UploadedFile</code> instances from <code>$_FILES</code> or similar format. Also contains
  a factory method <code>createFromEnvironment(Environment $env)</code> that is framework specific
  and makes use of <code>parseUploadedFiles</code>.</li>
<li><a href="https://github.com/slimphp/Slim/blob/30cfe3c07dac28ec1129c0577e64b90ba11a54c4/Slim/Http/Uri.php#L112-L121"><code>Uri</code></a> Requires <code>string $scheme</code> and <code>string $host</code>. Contains a factory
  method <code>createFromString($uri)</code> that can be used to create a <code>Uri</code> from a string.</li>
</ul>
<p><em>Being geared towards server usage only, Slim does not contain an implementation
of <code>Request</code>. The implementation listed above is an implementation of <code>ServerRequest</code>.</em></p>
<p>Of the compared approaches, Slim is most different from the proposed factories.
Most notably, the <code>Request</code> implementation contains requirements specific
to the framework that are not defined in HTTP Messages specification. The factory
methods that are included are generally similar with the proposed factories.</p>
<h3 id="43-potential-issues">4.3 Potential Issues</h3>
<p>The most difficult task in establishing this standard will be defining the
method signatures for the interfaces. As there is no clear declaration in PSR-7
as to what values are explicitly required, the properties that are read-only
must be inferred based on whether the interfaces have methods to copy-and-modify
the object.</p>
<h2 id="5-design-decisions">5. Design Decisions</h2>
<h3 id="51-why-php-7">5.1 Why PHP 7?</h3>
<p>While PSR-7 does not target PHP 7, the authors of this specification note that,
at the time of writing (April 2018), PHP 5.6 stopped receiving bugfixes 15
months ago, and will no longer receive security patches in 8 months; PHP 7.0
itself will stop receiving security fixes in 7 months (see the <a href="http://php.net/supported-versions.php">PHP supported
versions document</a> for current support details). Since
specifications are meant to be long-term, the authors feel the specification
should target versions that will be supported for the foreseeable future; PHP 5
will not. As such, from a security standpoint, targeting anything under PHP 7 is
a disservice to users, as doing so would be tacit approval of usage of
unsupported PHP versions.</p>
<p>Additionally, and equally importantly, PHP 7 gives us the ability to provide
return type hints to interfaces we define. This guarantees a strong,
predicatable contract for end users, as they can assume that the values returned
by implementations will be exactly what they expect.</p>
<h3 id="52-why-multiple-interfaces">5.2 Why multiple interfaces?</h3>
<p>Each proposed interface is (primarily) responsible for producing one PSR-7 type.
This allows consumers to typehint on exactly what they need: if they need a
response, they typehint on <code>ResponseFactoryInterface</code>; if they need a URI, they
typehint on <code>UriFactoryInterface</code>. In this way, users can be granular about what
they need.</p>
<p>Doing so also allows application developers to provide anonymous implementations
based on the PSR-7 implementation they are using, producing only the instances
they need for the specific context. This reduces boilerplate; developers do not
need to write stubs for unused methods.</p>
<h3 id="53-why-does-the-reasonphrase-argument-to-the-responsefactoryinterface-exist">5.3 Why does the $reasonPhrase argument to the ResponseFactoryInterface exist?</h3>
<p><code>ResponseFactoryInterface::createResponse()</code> includes an optional string
argument, <code>$reasonPhrase</code>. In the PSR-7 specification, you can only provide a
reason phrase at the same time you provide a status code, as the two are related
pieces of data. The authors of this specification have chosen to mimic the PSR-7
<code>ResponseInterface::withStatus()</code> signature to ensure both sets of data may be
present in the response created.</p>
<h3 id="54-why-does-the-serverparams-argument-to-the-serverrequestfactoryinterface-exist">5.4 Why does the $serverParams argument to the ServerRequestFactoryInterface exist?</h3>
<p><code>ServerRequestFactoryInterface::createServerRequest()</code> includes an optional
<code>$serverParams</code> array argument. The reason this is provided is to ensure that an
instance can be created with the server params populated. Of the data accessible
via the <code>ServerRequestInterface</code>, the only data that does not have a mutator
method is the one corresponding to the server params. As such, this data MUST be
provided at initial creation. For this reason, it exists as an argument to the
factory method.</p>
<h3 id="55-why-is-there-no-factory-for-creating-a-serverrequestinterface-from-superglobals">5.5 Why is there no factory for creating a ServerRequestInterface from superglobals?</h3>
<p>The primary use case of <code>ServerRequestFactoryInterface</code> is for creating a new
<code>ServerRequestInterface</code> instance from known data. Any solution around
marshaling data from superglobals assumes that:</p>
<ul>
<li>superglobals are present</li>
<li>superglobals follow a specific structure</li>
</ul>
<p>These two assumptions are not always true. When using asynchronous systems such
as <a href="https://www.swoole.co.uk/">Swoole</a>, <a href="https://reactphp.org/">ReactPHP</a>, and others:</p>
<ul>
<li>will not populate standard superglobals such as <code>$_GET</code>, <code>$_POST</code>, <code>$_COOKIE</code>,
  and <code>$_FILES</code></li>
<li>will not populate <code>$_SERVER</code> with the same elements as a standard SAPI (such as
  mod_php, mod-cgi, and mod-fpm)</li>
</ul>
<p>Moreover, different standard SAPIs provide different information to <code>$_SERVER</code>
and access to request headers, requiring different approaches for initial
population of the request.</p>
<p>As such, designing an interface for population of an instance from superglobals
is out of scope of this specification, and should largely be
implementation-specfic.</p>
<h3 id="56-why-does-requestfactoryinterfacecreaterequest-allow-a-string-uri">5.6 Why does RequestFactoryInterface::createRequest allow a string URI?</h3>
<p>The primary use case of <code>RequestFactoryInterface</code> is to create a request, and
the only required values for any request are the request method and a URI. While
<code>RequestFactoryInterface::createRequest()</code> can accept a <code>UriInterface</code> instance,
it also allows a string.</p>
<p>The rationale is two-fold. First, the majority use case is to create a request
instance; creation of the URI instance is secondary. Requiring a <code>UriInterface</code>
means users would either need to also have access to a <code>UriFactoryInterface</code>, or
the <code>RequestFactoryInterface</code> would have a hard requirement on a
<code>UriFactoryInterface</code>. The first complicates usage for consumers of the factory,
the second complicates usage for either developers of the factory, or those
creating the factory instance.</p>
<p>Second, <code>UriFactoryInterface</code> provides exactly one way to create a
<code>UriInterface</code> instance, and that is from a string URI. If creation of the URI
is based on a string, there's no reason for the <code>RequestFactoryInterface</code> not to
allow the same semantics. Additionally, every PSR-7 implementation surveyed at
the time this proposal was developed allowed a string URI when creating a
<code>RequestInterface</code> instance, as the value was then passed to whatever
<code>UriInterface</code> implementation they provided. As such, accepting a string is
expedient and follows existing semantics.</p>
<h2 id="6-people">6. People</h2>
<p>This PSR was produced by a FIG Working Group with the following members:</p>
<ul>
<li>Woody Gilk (editor), <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#111;&#100;&#121;&#46;&#103;&#105;&#108;&#107;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#119;&#111;&#111;&#100;&#121;&#46;&#103;&#105;&#108;&#107;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
<li>Matthew Weier O'Phinney (sponsor), <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#109;&#119;&#101;&#105;&#101;&#114;&#111;&#112;&#104;&#105;&#110;&#110;&#101;&#121;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#109;&#119;&#101;&#105;&#101;&#114;&#111;&#112;&#104;&#105;&#110;&#110;&#101;&#121;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
<li>Stefano Torresi</li>
<li>Matthieu Napoli</li>
<li>Korvin Szanto</li>
<li>Glenn Eggleton</li>
<li>Oscar Otero</li>
<li>Tobias Nyholm</li>
</ul>
<p>The working group would also like to acknowledge the contributions of:</p>
<ul>
<li>Paul M. Jones, <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#109;&#106;&#111;&#110;&#101;&#115;&#56;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#112;&#109;&#106;&#111;&#110;&#101;&#115;&#56;&#56;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
<li>Rasmus Schultz, <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#97;&#115;&#109;&#117;&#115;&#64;&#109;&#105;&#110;&#100;&#112;&#108;&#97;&#121;&#46;&#100;&#107;">&#114;&#97;&#115;&#109;&#117;&#115;&#64;&#109;&#105;&#110;&#100;&#112;&#108;&#97;&#121;&#46;&#100;&#107;</a></li>
<li>Roman Tsjupa, <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#100;&#114;&#97;&#99;&#111;&#110;&#121;&#115;&#116;&#101;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#100;&#114;&#97;&#99;&#111;&#110;&#121;&#115;&#116;&#101;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
</ul>
<h2 id="7-votes">7. Votes</h2>
<ul>
<li><a href="https://groups.google.com/forum/#!topic/php-fig/6rZPZ8VglIM">Entrance Vote</a></li>
<li><a href="https://groups.google.com/d/msg/php-fig/A5mZYTn5Jm8/j0FN6eZtBAAJ">Working Group Formation</a></li>
<li><a href="https://groups.google.com/d/msg/php-fig/OpUnkrnFhe0/y2dT7CakAQAJ">Review Period Initiation</a></li>
<li><a href="https://groups.google.com/d/msg/php-fig/M8PapGXXE1E/uBq2Dq-ZAwAJ">Acceptance Vote</a></li>
</ul>
<h2 id="8-relevant-links">8. Relevant Links</h2>
<p><em><strong>Note:</strong> Order descending chronologically.</em></p>
<ul>
<li><a href="https://github.com/php-fig/fig-standards/pull/755">PSR-7 Middleware Proposal</a></li>
<li><a href="https://groups.google.com/forum/#!topic/php-fig/vTtGxdIuBX8">PHP-FIG mailing list discussion of middleware</a></li>
<li><a href="http://blog.ircmaxell.com/2016/05/all-about-middleware.html">ircmaxwell All About Middleware</a></li>
<li><a href="http://shadowhand.me/all-about-psr-7-middleware/">shadowhand All About PSR-7 Middleware</a></li>
<li><a href="http://andrewcarteruk.github.io/programming/2016/05/22/psr-7-is-not-immutable.html">AndrewCarterUK PSR-7 Objects Are Not Immutable</a></li>
<li><a href="http://shadowhand.me/dependency-inversion-and-psr-7-bodies/">shadowhand Dependency Inversion and PSR-7 Bodies</a></li>
<li><a href="https://groups.google.com/d/msg/php-fig/G5pgQfQ9fpA/UWeM1gm1CwAJ">PHP-FIG mailing list thread discussing factories</a></li>
<li><a href="https://groups.google.com/d/msg/php-fig/piRtB2Z-AZs/8UIwY1RtDgAJ">PHP-FIG mailing list thread feedback on proposal</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
      
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
      
        <script src="../../js/init.js"></script>
      
    
  </body>
</html>